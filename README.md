## Car Price Prediction with Airflow

Этот проект представляет собой пайплайн машинного обучения для предсказания цен автомобилей, который также интегрирован с Airflow для автоматизации и мониторинга.

## Описание проекта

Проект реализует модель машинного обучения, способную предсказывать цены автомобилей по различным характеристикам. Модель обучается на данных, после чего ее можно использовать для мультиклассовых предсказаний.

Для автоматизации и мониторинга процессов используется Apache Airflow. Процесс включает в себя несколько шагов:

1. **Подготовка данных**: Предварительная обработка данных и их подготовка для обучения модели.
   - Удаление ненужных столбцов.
   - Удаление выбросов.
   - Создание новых признаков.

2. **Обучение модели**: Формирование и сохранение модели машинного обучения.
   - Загрузка данных из CSV файла.
   - Предварительная обработка данных (импутация пропущенных значений, масштабирование числовых признаков).
   - Обучение нескольких моделей машинного обучения (логистическая регрессия, случайный лес, SVM) и выбор лучшей модели на основе кросс-валидации.
   - Сохранение обученной модели в файл.

3. **Предсказания**: Использование обученной модели для предсказания цен автомобилей на тестовых данных.
   - Загрузка обученной модели из файла.
   - Загрузка тестовых данных из JSON файлов.
   - Применение модели к тестовым данным для получения предсказаний.
   - Сохранение предсказаний в CSV файл.

4. **Мониторинг с помощью Airflow**: DAG в Airflow управляет процессом, позволяя контролировать и автоматизировать выполнение задач.
   - Определение DAG.
   - Определение задач в DAG (подготовка данных, обучение модели, предсказания).
   - Настройка расписания для автоматического запуска DAG в определенное время.

## Структура проекта

```plaintext
dags/
    hw_dag.py          # Основной DAG для управления пайплайном в Airflow.
data/
    models/            # Сохраненные модели для предсказаний с датой выполнения.
    predictions/       # Результаты предсказаний.
    train/             # Исходные данные для обучения модели.
    test/              # Тестовые данные для предсказаний.
modules/
    pipeline.py        # Скрипт для обработки данных и обучения модели.
    predict.py         # Скрипт для выполнения предсказаний на основе обученной модели.
```

## Использование

Адаптировано под локальный запуск. Необходимо предварительно настроить Airflow.

1. Клонируйте репозиторий:
   ```bash
   git clone git@github.com:temeka1221/carprice-predictions-airflow.git
   ```

2. Скопируйте DAG в директорию Airflow:
   ```bash
   cp dags/hw_dag.py ~/airflow/dags/hw_dag.py
   ```

3. Активируйте ваше окружение Airflow.

4. Запустите Airflow:
   ```bash
   airflow webserver -p 8090
   airflow scheduler
   ```

5. Перейдите на [http://localhost:8090/](http://localhost:8090/) для управления DAG.

## Требования

- Python 3.x+
- Apache Airflow
- Другие библиотеки, указанные в `requirements.txt`

## Имя автора

Кокорев Артем | temeka

## Лицензия

Этот проект лицензирован на условиях MIT. Смотрите файл LICENSE.
